@model tourBD.Web.Models.CompanyModels.EditCompanyViewModel

@section Styles {

    <style>
        .image-update {
            margin-bottom: 15px;
            padding: 0 5px;
        }

        #filePhoto {
            margin-top: 5px;
        }

        .package-list {
            font-weight: 600;
            font-size: 20px;
            border: 1px solid gray;
            box-shadow: 2px 2px 2px #888888;
            text-align: center;
            line-height: 37px;
        }

        .create-package .package-create-link {
            width: 400px;
            text-align: center;
            margin: 0 auto;
            box-shadow: 2px 2px 2px #888888;
        }

        .create-package .package-create-link a {
            width: 100%;
            text-align: center;
        }

        label span.color-ml-3 {
            margin-left: 3px;
            color: coral;

        }

    </style>

}

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-10" style="margin: 0 auto">
            <form enctype="multipart/form-data" method="post" asp-controller="Company" asp-action="EditCompany">

                <input hidden asp-for="@Model.Company.Id" />
                <input hidden asp-for="@Model.Company.UserId" />
                <input hidden asp-for="@Model.Company.CompanyImageUrl" />
                <input hidden asp-for="@Model.Company.Reputation" />

                <div class="image-update row">
                    <div class="existing-cover-photo">
                        <img src="@Model.Company.CompanyImageUrl"
                             alt="Company image"
                             id="cover-photo" style="width: 100%; height: 100%" />
                    </div>
                </div>

                <div class="form-group row" style="margin-left: 0px">
                    <input type="file" name="ImageFile" id="filePhoto" />
                </div>

                <div class="form-group row">
                    <label asp-for="@Model.Company.Name" class="col-lg-1 col-form-label"></label>
                    <div class="col-lg-6">
                        <input asp-for="@Model.Company.Name" class="form-control" placeholder="Company Name" />
                        <span asp-validation-for="@Model.Company.Name" class="text-danger"></span>
                    </div>
                </div>

                <div class="form-group row">
                    <label asp-for="@Model.Company.Address" class="col-lg-1 col-form-label"></label>
                    <div class="col-lg-6">
                        <input asp-for="@Model.Company.Address" class="form-control" placeholder="Company Address" />
                        <span asp-validation-for="@Model.Company.Address" class="text-danger"></span>
                    </div>
                </div>

                @* Tour packages *@

                <div class="form-group row">
                    <div class="col-lg-10">
                        <button type="submit" class="btn btn-primary">Update</button>
                        <a asp-controller="Company" asp-action="Index" class="btn btn-outline-success">Done</a>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="row mt-5">
        <div class="col-lg-6">
            <p class="package-list">List of packages</p>
        </div>
        <div class="create-package col-lg-6">
            <div class="package-create-link">
                <a class="btn btn-primary" asp-controller="Company" asp-action="CreatePackage" asp-route-companyId="@Model.Company.Id.ToString()"><i class="fas fa-plus-square"></i> Create Package</a>
            </div>
        </div>
    </div>

    <div class="row">
        @foreach (var package in Model.Company.TourPackages)
        {
            <div class="col-lg-3">
                <div class="card">
                    <div class="card-header">
                        <div class="header-left float-left">
                            <label>Package Number: <span class="color-ml-3">@package.PackageNumber</span></label> <br />
                            <label>Area: <span class="color-ml-3">@package.MainArea</span></label>
                        </div>
                        <div class="header-right float-right">
                            @if (package.Availability == tourBD.Membership.Enums.AvailabilityStatus.Available.ToString())
                            {
                                <button class="btn btn-success available">@package.Availability</button>
                            }
                            else {
                                <button class="btn btn-danger available">@package.Availability</button>
                            }
                        </div>
                    </div>
                    <div class="card-body">
                        <p>Including spots</p>
                        <ul class="spot-list">
                            @foreach (var spot in package.Spots)
                            {
                                <li>@spot.Name</li>
                            }
                        </ul>
                    </div>
                    <div class="card-footer">
                        <a class="btn btn-primary" asp-controller="Company" asp-action="EditPackage" asp-route-packageId="@package.Id.ToString()" asp-route-companyId="@Model.Company.Id.ToString()">Edit</a>
                        <a class="btn btn-primary" asp-controller="Company" asp-action="DeletePackage" asp-route-packageId="@package.Id.ToString()" asp-route-companyId="@Model.Company.Id.ToString()">Delete</a>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

@section Scripts {
    <script type="text/javascript">
        $(document).ready(function () {
            $('#filePhoto').change(function () {

                if (this.files && this.files[0]) {
                    var reader = new FileReader();
                    reader.onload = (e) => {
                        $('#cover-photo').attr('src', e.target.result);
                    };

                    reader.readAsDataURL(this.files[0]);
                }

            })
        });
    </script>
}